在uCOS（包括uCOS-II和uCOS-III）中，任务状态转换由系统调度器、任务自身行为（调用API）或外部事件（如中断）触发。以下是核心状态间的转换逻辑及触发条件，按基础状态和复合状态分类说明：

---

### ⚙️ **一、基础状态转换**  
1. **就绪态（Ready） ↔ 运行态（Running）**  
   - **就绪 → 运行**：调度器选中当前最高优先级任务执行。  
   - **运行 → 就绪**：  
     - 时间片耗尽（时间片轮转调度）；  
     - 更高优先级任务就绪（抢占式调度）；  
     - 任务主动调用 `OSTimeDly()` 或 `OS_Sched()` 让出CPU。  

2. **运行态 → 等待/阻塞态（Waiting）**  
   - **触发条件**：  
     - 调用延时函数（如 `OSTimeDly()`）进入延时阻塞；  
     - 等待事件（如 `OSSemPend()`、`OSQPend()`）进入事件阻塞。  

3. **等待态 → 就绪态**  
   - **触发条件**：  
     - 延时结束（`OSTimeDly()` 超时）；  
     - 等待的事件发生（如信号量释放、消息到达）；  
     - 等待超时（有限等待模式下）。  

4. **任意状态 ↔ 挂起态（Suspended）**  
   - **→ 挂起**：调用 `OSTaskSuspend()`，任务被强制暂停。  
   - **挂起 → 就绪**：调用 `OSTaskResume()` 恢复任务。  

5. **就绪/运行态 → 删除态（Deleted）**  
   - **触发条件**：调用 `OSTaskDel()` 删除任务，资源被回收。  

---

### 🔄 **二、复合状态转换**  
复合状态由基础状态叠加挂起操作形成，需同时满足两个条件才能恢复就绪：  
1. **延时+挂起态 → 就绪态**  
   - 需同时满足：延时结束 **且** 被 `OSTaskResume()` 恢复。  
2. **等待+挂起态 → 就绪态**  
   - 需同时满足：等待事件发生 **且** 被恢复。  
3. **超时等待+挂起态 → 就绪态**  
   - 需满足：等待超时或事件发生 **且** 被恢复。  

> 💎 **关键机制**：挂起状态会冻结其他状态（如延时、等待），只有解除挂起后，原状态（延时/等待）才能继续生效。

---

### 📊 **三、状态转换表与API关联**  
| **当前状态**       | **目标状态**   | **触发方式**                     | **关键API或事件**               |  
|--------------------|----------------|----------------------------------|--------------------------------|  
| 就绪态 (Ready)     | 运行态         | 调度器选择                       | `OS_Scheduler()`              |  
| 运行态 (Running)   | 就绪态         | 时间片耗尽/更高优先级任务就绪    | `OS_Sched()`, 中断事件         |  
| 运行态             | 等待态         | 主动等待事件或延时               | `OSSemPend()`, `OSTimeDly()`   |  
| 等待态 (Waiting)   | 就绪态         | 事件发生或超时                   | `OSSemPost()`, 超时中断        |  
| 任意状态           | 挂起态         | 强制挂起任务                     | `OSTaskSuspend()`             |  
| 挂起态 (Suspended) | 就绪态         | 恢复任务                         | `OSTaskResume()`              |  
| 任意状态           | 删除态         | 删除任务                         | `OSTaskDel()`                 |  

---

### ⚠️ **四、注意事项**  
1. **版本差异**：  
   - uCOS-II 的“睡眠态”（任务未初始化）在 uCOS-III 中不再使用。  
   - uCOS-III 明确区分“等待超时”和“无限等待”子状态。  
2. **中断影响**：  
   - 中断可触发事件（如释放信号量），使等待态任务转为就绪态。  
3. **复合状态优先级**：  
   - 挂起状态的优先级最高，会覆盖延时/等待状态。  

> 🔧 **实践建议**：  
> - 避免低优先级任务饥饿：高优先级任务需调用 `OSTimeDly()` 主动让出CPU。  
> - 慎用 `OSTaskSuspend()`：挂起任务可能导致复合状态，增加调试复杂度。  
> - 删除任务前确保其未持有资源（如信号量），防止内存泄漏。  

理解状态转换机制是优化任务调度的基础，合理使用API可避免死锁和资源竞争问题。